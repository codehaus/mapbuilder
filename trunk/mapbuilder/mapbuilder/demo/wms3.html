<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--
Description: A Browser based Web Map Server Client based on javascript and XSL
             libraries from http://mapbuilder.sourceforge.net .
Usage:       Call http://hostname/dir/wms.html?context=UrlOfContext
             or http://hostname/dir/wms.html (and a default context is used)
Licence:     GPL as per: http://www.gnu.org/copyleft/gpl.html

$Id$
$Name$
-->

<html>
  <head>
    <title>WMS Client</title>

    <!-- Include mapbuilder libraries -->
    <script type="text/javascript" src="../lib/util/sarissa/Sarissa.js"></script>
    <script type="text/javascript" src="../lib/util/Util.js"></script>
    <script type="text/javascript" src="../lib/model/Config.js"></script>
    <link rel="stylesheet" href="../lib/skin/default/html.css" type="text/css">

    <script>
      //initialize the application configuration object - global scope
      var config = new Config("config/CompleteTemplate.xml");
      var buttonBar = null;
      var mapPane = null;

      config.contextArray = new Array();
      config.loadContext = function( contextUrl ) {

          // Load a Web Map Context document 
          var context = new Context( contextUrl ,"context", "/mapbuilder/lib", "default");
          this.contextArray.push( context );

          // Create and render a MapPane
          //this should register itself as a view of the context; context calls paint initially
          mapPane = new MapPane( context, "mapPane",document.getElementById("mapPaneDiv"));
          mapPane.paint();

          //add mouse handler function
          mapPane.mouseHandler = new GlassPane( mapPane, 'MODE_ZOOM_IN' );
          mapPane.mouseHandler.setCursorTrackForm( document.MapDisplayForm );
          mapPane.mouseHandler.setAOIForm( document.AOIForm );

          //create a button bar
          buttonBar = new ButtonBar2( mapPane.mouseHandler, document.getElementById("ButtonBar") );

          // Create and render a Legend
          //this should register itself as a view of the context; context calls paint initially
          legend=new Legend( context, "legend", document.getElementById("legendDiv"));
          legend.paint();

          // Create and render a PanTool
          panTool=new PanTool( context,"panTool",document.getElementById("panToolDiv"));
          panTool.paint();

          // Create and render a ZoomTool
          zoomTool=new ZoomTool(context,"zoomTool",document.getElementById("zoomToolDiv"));
          zoomTool.paint();
      }


    </script>

  </head>

  <body>
    <h1><a href="http://mapbuilder.sourceforge.net">Mapbuilder</a>
      Web Map Server Client</h1>

<P>Built using config file.</P>

    <!-- Layout mapbuilder widgets and HTML -->
    <table>
      <tr>
        <td valign="top">
          <div id="mapPaneDiv"></div>
        </td>
        <td valign="top">
          <div id="panToolDiv"></div>
          <br/>
          <div id="zoomToolDiv"></div>
          <br/>
          <div id="legendDiv"></div>
        </td>
      </tr>

      <tr>
        <td valign="top">
           <table width="100%">
            <tr>
                <td align="left" valign="top" ID="ButtonBar">
                </td>
                <td align="right" valign="top">
            <FORM NAME="MapDisplayForm" ID="MapDisplayForm" STYLE="margin:0; padding:0;">
                    long:&nbsp;<input NAME="longitude" TYPE="text" SIZE="6" CLASS="bareinput">
                    &nbsp;&nbsp;&nbsp;
                    lat:&nbsp;<input NAME="latitude" TYPE="text" SIZE="6" CLASS="bareinput">
            </FORM>
                </td>
              </tr>
            </table>
          </td>

          <td>
          </td>
        </tr>

      <tr>

        <td ID="mapList"></td>

        <td valign="top">
            <FORM NAME="AOIForm" ID="AOIForm" STYLE="margin:0; padding:0;">
            Area of Interest:<BR/>
            north:&nbsp;<input NAME="northbc" TYPE="text" SIZE="6"/><BR/>
            south:&nbsp;<input NAME="southbc" TYPE="text" SIZE="6"/><BR/>
            east:&nbsp;<input NAME="eastbc" TYPE="text" SIZE="6"/><BR/>
            west:&nbsp;<input NAME="westbc" TYPE="text" SIZE="6"/>
            </FORM>
        </td>
      </tr>
    </table>
    <p><i>A <a href="http://mapbuilder.sourceforge.net">Community Map Builder</a> Project</i></p>

    <!-- Initialise mapbuilder components -->
    <script>
      cgiArgs=getArgs();
      if (!cgiArgs.context) {
        cgiArgs.context="context/wmc.xml";
      }

      config.loadContext( cgiArgs.context );

      var collection = new Collection("context/demoCollection.ccml");
      var contextList = new CollectionList(collection, document.getElementById("mapList"));
      contextList.paint();
    </script>
  </body>
</html>
