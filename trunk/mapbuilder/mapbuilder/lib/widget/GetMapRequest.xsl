<?xml version="1.0" encoding="ISO-8859-1"?><!--Description: parses an OGC context document to generate an array of DHTML layers.Author:      adairLicence:     GPL as specified in http://www.gnu.org/copyleft/gpl.html .$Id: MapPane.xsl,v 1.13 2004/08/26 04:28:14 madair1 Exp $$Name:  $--><xsl:stylesheet version="1.0"     xmlns:cml="http://www.opengis.net/context" 		xmlns:sld="http://www.opengis.net/sld"    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"     xmlns:xlink="http://www.w3.org/1999/xlink">  <xsl:output method="xml"/>  <xsl:strip-space elements="*"/>  <!--  <xsl:include href="ogcMapImgObjects.xsl" />  -->  <!-- The coordinates of the DHTML Layer on the HTML page -->  <xsl:param name="modelId"/>  <xsl:param name="widgetId"/>    <xsl:param name="bbox"/>  <xsl:param name="width"/>  <xsl:param name="height"/>  <xsl:param name="srs"/>  <xsl:param name="version"/>  <xsl:param name="baseUrl"/>  <xsl:param name="mbId"/>    <xsl:template match="Layer">    <xsl:variable name="visibility">      <xsl:choose>        <xsl:when test="@hidden='1'">hidden</xsl:when>        <xsl:otherwise>visible</xsl:otherwise>      </xsl:choose>    </xsl:variable>    <xsl:variable name="firstJoin">      <xsl:choose>        <xsl:when test="substring($baseUrl,string-length($baseUrl))='?'"></xsl:when>        <xsl:when test="contains($baseUrl, '?')">&amp;</xsl:when>         <xsl:otherwise>?</xsl:otherwise>      </xsl:choose>    </xsl:variable>    <xsl:variable name="mapRequest">      <xsl:choose>        <xsl:when test="starts-with($version, '1.0')">            WMTVER=<xsl:value-of select="$version"/>&amp;REQUEST=map        </xsl:when>                    <xsl:otherwise>            VERSION=<xsl:value-of select="$version"/>&amp;REQUEST=GetMap        </xsl:otherwise>      </xsl:choose>    </xsl:variable>    <DIV>          <xsl:attribute name="STYLE">position:absolute; visibility:<xsl:value-of select="$visibility"/>; top:0; left:0;</xsl:attribute>      <xsl:attribute name="ID"><xsl:value-of select="$mbId"/></xsl:attribute>          <xsl:element name="IMG">            <xsl:variable name="src">                <xsl:value-of select="$baseUrl"/>            <xsl:value-of select="$firstJoin"/>            <xsl:value-of select="$mapRequest"/>   &amp;SRS=<xsl:value-of select="$srs"/>  &amp;BBOX=<xsl:value-of select="$bbox"/> &amp;WIDTH=<xsl:value-of select="$width"/>&amp;HEIGHT=<xsl:value-of select="$height"/>&amp;LAYERS=<xsl:value-of select="Name"/><!--&amp;STYLES=<xsl:value-of select="translate(StyleList/Style[@current='1']/Name,' ','+')"/>-->&amp;FORMAT=image/gif&amp;TRANSPARENT=true<!--	  //TBD: these still to be properly handled   //also sld support  if (this.transparent) src += '&' + 'TRANSPARENT=' + this.transparent;	if (this.bgcolor) src += '&' + 'BGCOLOR=' + this.bgcolor;	//if (this.exceptions) src += '&' + 'EXCEPTIONS=' + this.exceptions;	if (this.vendorstr) src += '&' + this.vendorstr;  //        -->        </xsl:variable>        <xsl:attribute name="SRC">                <xsl:value-of select="translate(normalize-space($src),' ', '' )" disable-output-escaping="no"/>        </xsl:attribute>        <xsl:attribute name="WIDTH">            <xsl:value-of select="$width"/>        </xsl:attribute>        <xsl:attribute name="HEIGHT">            <xsl:value-of select="$height"/>        </xsl:attribute>        <xsl:attribute name="ALT">            <xsl:value-of select="Title"/>        </xsl:attribute>    </xsl:element>        </DIV>      </xsl:template></xsl:stylesheet>